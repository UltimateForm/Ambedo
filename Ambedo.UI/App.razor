@page "/";
@using Ambedo.UI.Data.Services.Interfaces
@using Ambedo.Contract.Dtos
@using Blazorise
@using Blazorise.Components 
@using Ambedo.UI.Shared
@inject IDataService dataService;

<Blazorise.ThemeProvider Theme="@theme">
	<Layout Sider="true" Loading="thootles==null || thootles.Count==0">
		<LayoutSider>
			<LayoutSiderContent>
				<Bar Mode="BarMode.VerticalInline"
					 CollapseMode="BarCollapseMode.Small"
					 Breakpoint="Breakpoint.Desktop"
					 NavigationBreakpoint="Breakpoint.Tablet"
					 ThemeContrast="ThemeContrast.Dark">
					<SidebarForm />
				</Bar>
			</LayoutSiderContent>
		</LayoutSider>
		<LayoutContent Padding="Padding.Is2.OnAll" Class="cardsContainer">
			@foreach (var thootle in thootles)
			{
					<Card Background="Background.Dark" Margin="Margin.Is1.OnAll" ColumnSize="ColumnSize.Is2.OnDesktop.IsFull.OnMobile" >
						<CardBody>
							<CardTitle Color="TextColor.Secondary" Size="5">@thootle.Content</CardTitle>
							<CardText>
								@thootle.Categories.Select(c => c.ToString()).Aggregate((current, next) => $"{current} | {next}")
							</CardText>
						</CardBody>
					</Card>

			}
		</LayoutContent>
	</Layout>
</Blazorise.ThemeProvider>

@code {
	private Theme theme = new Theme
	{
		BarOptions = new ThemeBarOptions
		{
			VerticalWidth = "400px"
		},
	};
	public List<Thootle> thootles = new List<Thootle>();
	protected override async Task OnInitializedAsync()
	{
		var apiTootles = await dataService.GetThootlesAsync();
		thootles.AddRange(apiTootles);
	}
}